@import '../mixins/active-box-shadow';

.theming-button-widgets(@button-border-color) {
	.oo-ui-buttonGroupWidget {
		.oo-ui-buttonElement-framed {
			&.oo-ui-widget-disabled + .oo-ui-widget-disabled {
				> .oo-ui-buttonElement-button {
					border-left-color: rgba(@button-border-color, @opacity--disabled);
				}
			}
		}

		&.oo-ui-widget-enabled {
			.oo-ui-buttonElement {
				&.oo-ui-toggleWidget-on + .oo-ui-toggleWidget-on {
					> .oo-ui-buttonElement-button,
					> .oo-ui-buttonElement-button:active {
						border-left-color: @button-border-color;
					}
				}
			}
		}
	}

	.oo-ui-buttonSelectWidget {
		.oo-ui-buttonOptionWidget {
			&.oo-ui-widget-disabled + .oo-ui-widget-disabled {
				> .oo-ui-buttonElement-button {
					border-left-color: rgba(@button-border-color, 0.5);
				}
			}
		}
	}
}

.theming-checkboxes(@color--active, @color--inactive) {
	.oo-ui-checkboxInputWidget {
		color: @color--active;

		[type='checkbox'] {
			+ span,
			&:indeterminate + span::before,
			&:disabled + span,
			&:checked:disabled + span,
			&:checked:disabled + span::before {
				border-color: @color--inactive;
			}
		}
	}
}

.theming-dropdowns(@accent-color, @is-dark-theme: false) {
	@dropdown-background-color: if(@is-dark-theme, #3a3a3a, @wds-color-white);
	@dropdown-border-color: if(@is-dark-theme, rgba(@wds-color-white, 0.5), @wds-fandom-color-mid-light-gray);

	.oo-ui-dropdownWidget {
		&-handle {
			background-color: @dropdown-background-color;
			border-color: @dropdown-border-color;
		}

		&.oo-ui-widget-enabled &-handle {
			&:hover,
			&:focus,
			&:active {
				border-color: @accent-color;
			}

			&:active {
				.active-box-shadow(@accent-color);
			}
		}
	}
}

.theming-menuOptions(@accent-color, @is-dark-theme: false) {
	@accent-color--fadeout: fadeout(@accent-color, 90%);

	@select-background-color: if(@is-dark-theme, #3a3a3a, @wds-color-white);
	@select-border-color: if(@is-dark-theme, rgba(@wds-color-white, 0.5), @wds-fandom-color-mid-light-gray);

	.oo-ui-menuOptionWidget {
		&.oo-ui-optionWidget {
			&-highlighted,
			&-selected {
				background-color: @accent-color--fadeout;
				color: @accent-color;
			}
		}
	}

	.oo-ui-menuSelectWidget {
		background-color: @select-background-color;
		border: @select-border-color;
		box-shadow: 0 3px 12px 0 rgba(@wds-fandom-color-black, 0.3);
	}
}

.theming-outlineControls() {
	.oo-ui-outlineControlsWidget {
		//background-color: @background-color-base;
		background-color: orange;
	}

	.oo-ui-outlineOptionWidget {
		&.oo-ui-optionWidget-highlighted,
		&.oo-ui-optionWidget-selected,
		&.oo-ui-optionWidget-pressed {
			//background-color: @primary-color--fadeout;
			//color: @primary-color;
			color: green;
		}
	}
}

.theming-popups(@font-color, @is-dark-theme: false) {
	@popup-background-color: if(@is-dark-theme, #3a3a3a, @wds-color-white);
	@popup-border-color: if(@is-dark-theme, rgba(@wds-color-white, 0.5), @wds-fandom-color-mid-light-gray);

	.oo-ui-popupWidget {
		&-popup {
			background-color: @popup-background-color;
			border: @popup-border-color;
			color: @font-color;
			filter: drop-shadow(0 2px 1px rgba(@wds-color-black, 0.3));
		}

		&-anchored-top {
			.oo-ui-popupWidget-anchor {
				&::before,
				&::after {
					border-bottom-color: @popup-border-color;
				}
			}
		}

		&-anchored-bottom {
			.oo-ui-popupWidget-anchor {
				&::before,
				&::after {
					border-top-color: @popup-border-color;
				}
			}
		}

		&-anchored-start {
			.oo-ui-popupWidget-anchor {
				&::before,
				&::after {
					border-right-color: @popup-border-color;
				}
			}
		}

		&-anchored-end {
			.oo-ui-popupWidget-anchor {
				&::before,
				&::after {
					border-left-color: @popup-border-color;
				}
			}
		}
	}
}

.theming-progressBars(@accent-color, @is-dark-theme: false) {
	@background-color: if(@is-dark-theme, rgba(@wds-color-white, 0.15), rgba(@wds-color-black, 0.15));
	@border-color: if(@is-dark-theme, rgba(@wds-color-white, 0.5), rgba(@wds-color-black, 0.5));

	.oo-ui-progressBarWidget {
		background-color: @background-color;
		border-color: @border-color;

		&.oo-ui-widget-enabled {
			.oo-ui-progressBarWidget-bar {
				background-color: @accent-color;
			}
		}

		&.oo-ui-widget-disabled {
			.oo-ui-progressBarWidget-bar {
				background-color: if(@is-dark-theme, rgba(@wds-color-white, 0.5), rgba(@wds-color-black, 0.5));
			}
		}
	}
}

.theming-radios(@color--active, @color--inactive) {
	.oo-ui-radioInputWidget {
		[type='radio'] {
			+ span,
			&:disabled + span {
				color: @color--inactive;
			}
		}

		&.oo-ui-widget-enabled [type='radio'] {
			&:hover + span,
			&:checked + span {
				color: @color--active;
			}
		}
	}
}

.theming-fileSelects(@accent-color, @is-dark-theme: false) {
	@background-color: if(@is-dark-theme, rgba(@wds-color-white, 0.15), rgba(@wds-color-black, 0.15));
	@border-color: if(@is-dark-theme, rgba(@wds-color-white, 0.5), rgba(@wds-color-black, 0.5));
	@accent-color--fadeout: fadeout(@accent-color, 90%);

	.oo-ui-selectFileWidget {
		&-dropTarget {
			background-color: @background-color;
			border-color: @border-color;
		}

		&.oo-ui-widget-enabled {
			&.oo-ui-selectFileWidget-dropTarget {
				&:hover {
					border-color: @accent-color;
				}
			}

			&.oo-ui-selectFileWidget-canDrop {
				&.oo-ui-selectFileWidget-dropTarget,
				.oo-ui-selectFileInputWidget-info > .oo-ui-inputWidget-input {
					background-color: @accent-color--fadeout;
					color: @accent-color;
				}
			}
		}
	}
}

.theming-tabs(@accent-color, @is-dark-theme: false) {
	@background-color: if(@is-dark-theme, rgba(@wds-color-white, 0.15), rgba(@wds-color-black, 0.15));
	@accent-color--text: if(luma(@accent-color) < 50%, @wds-color-white, @wds-color-black);
	@background-color--text: if(@is-dark-theme, @wds-color-white, @wds-color-black);

	.oo-ui-tabSelectWidget {
		&-framed {
			background-color: transparent;
			border-bottom-color: @accent-color;
		}
	}

	.oo-ui-tabOptionWidget {
		.oo-ui-tabSelectWidget-framed & {
			background-color: @background-color;
			color: @background-color--text;

			&.oo-ui-optionWidget-selected {
				background-color: @accent-color;
				color: @accent-color--text;
			}

			&.oo-ui-widget-enabled {
				&:not(.oo-ui-optionWidget-selected):hover {
					color: @accent-color;
				}
			}
		}

		.oo-ui-tabSelectWidget-frameless & {
			&.oo-ui-optionWidget-selected,
			&.oo-ui-widget-enabled:active {
				box-shadow: inset 0 -2px 0 0 @accent-color;
				color: @accent-color;
			}

			&.oo-ui-widget-enabled:hover {
				color: @accent-color;
			}
		}
	}
}

.theming-tags(@accent-color, @alert-color, @is-dark-theme: false) {
	@tag-color--base: if(@is-dark-theme, @wds-color-white, @wds-color-black);
	@accent-color--fadeout: fadeout(@accent-color, 90%);
	@alert-color--fadeout: fadeout(@alert-color, 90%);
	@alert-color--active: if(luma(@alert-color) < 50%, lighten(@alert-color, 20%), darken(@alert-color, 20%));

	@background-color: if(@is-dark-theme, rgba(@wds-color-white, 0.15), rgba(@wds-color-black, 0.15));
	@background-color--outlined: if(@is-dark-theme, rgba(@wds-color-white, 0.25), rgba(@wds-color-black, 0.25));
	@border-color: if(@is-dark-theme, rgba(@wds-color-white, 0.5), rgba(@wds-color-black, 0.5));

	.oo-ui-tagItemWidget {
		border-color: currentColor;
		color: @tag-color--base;

		.oo-ui-buttonElement-button {
			color: inherit;

			&:hover {
				color: @accent-color;
			}
		}

		&.oo-ui-widget-enabled {
			background-color: transparent;

			&:hover,
			&:focus {
				background-color: @accent-color--fadeout;
				color: @accent-color;

				.oo-ui-buttonElement-button {
					color: @accent-color;
				}
			}

			&.oo-ui-flaggedElement-invalid {
				background-color: @alert-color--fadeout;
				color: @alert-color;

				&:hover,
				&:focus {
					color: @alert-color--active;
				}
			}
		}
	}

	.oo-ui-tagMultiselectWidget {
		&-handle {
			border-color: @border-color;
		}

		&.oo-ui-widget-enabled {
			.oo-ui-tagMultiselectWidget-handle {
				background-color: @background-color;
			}

			&.oo-ui-tagMultiselectWidget-inlined {
				&:hover .oo-ui-tagMultiselectWidget-handle {
					border-color: @accent-color;
				}

				&.oo-ui-tagMultiselectWidget-focus .oo-ui-tagMultiselectWidget-handle {
					border-color: @accent-color;
					.active-box-shadow(@accent-color);
				}

				&.oo-ui-flaggedElement-invalid {
					.oo-ui-tagMultiselectWidget-handle,
					&:hover .oo-ui-tagMultiselectWidget-handle {
						border-color: @alert-color;
					}
				}
			}

			&.oo-ui-tagMultiselectWidget-outlined {
				.oo-ui-tagMultiselectWidget-handle {
					background-color: @background-color--outlined;
				}

				&.oo-ui-flaggedElement-invalid .oo-ui-inputWidget-input {
					border-color: @alert-color;
				}
			}

			&.oo-ui-flaggedElement-invalid .oo-ui-inputWidget-input {
				color: @alert-color;
			}
		}
	}
}

.theming-toggles(@accent-color) {
	@accent-color--active: if(luma(@accent-color) < 50%, lighten(@accent-color, 20%), darken(@accent-color, 20%));

	.oo-ui-toggleSwitchWidget {
		background-color: @wds-fandom-color-middle-gray;

		&-grip {
			background-color: @wds-fandom-color-light-gray;
		}

		&.oo-ui-toggleWidget-on {
			background-color: desaturate(@accent-color--active, 30%);

			.oo-ui-toggleSwitchWidget-grip {
				background-color: @accent-color;
			}
		}
	}
}

.theming-inputs(@accent-color, @is-dark-theme: false) {
	@background-color: if(@is-dark-theme, rgba(@wds-color-white, 0.15), rgba(@wds-color-black, 0.15));
	@background-color--readonly: if(@is-dark-theme, rgba(@wds-color-white, 0.25), rgba(@wds-color-black, 0.25));
	@border-color: if(@is-dark-theme, rgba(@wds-color-white, 0.5), rgba(@wds-color-black, 0.5));

	@accent-color--fadeout: fadeout(@accent-color, 90%);

	.oo-ui-textInputWidget {
		.oo-ui-inputWidget-input {
			background-color: @background-color;
			border-color: @border-color;
		}

		.oo-ui-pendingElement-pending {
			background-color: @accent-color--fadeout;
		}

		> .oo-ui-labelElement-label {
			color: green;
		}

		&.oo-ui-widget-enabled {
			.oo-ui-inputWidget-input {
				.active-box-shadow(transparent);

				&:hover,
				&:focus {
					border-color: @accent-color;
				}

				&:focus {
					.active-box-shadow(@accent-color);
				}

				&[readonly] {
					background-color: @background-color--readonly;
				}
			}

			&.oo-ui-flaggedElement-invalid {
				.oo-ui-inputWidget-input {
					border-color: @alert-color;

					&:hover,
					&:focus {
						border-color: @alert-color;
					}

					&:focus {
						.active-box-shadow(@alert-color);
					}
				}
			}
		}
	}
}

.theming-messages(@alert-color, @warning-color, @success-color, @notice-color) {
	&.oo-ui-messageWidget-block {
		box-shadow: 0 2px 6px 0 rgba(@wds-color-black, 0.2);

		> .oo-ui-iconElement-icon {
			color: @wds-color-white;
		}

		> .oo-ui-labelElement-label {
			background-color: @wds-color-white;
			color: @wds-color-medium-gray;
		}

		&.oo-ui-flaggedElement-error {
			background-color: @alert-color;
		}

		&.oo-ui-flaggedElement-warning {
			background-color: @warning-color;
		}

		&.oo-ui-flaggedElement-success {
			background-color: @success-color;
		}

		&.oo-ui-flaggedElement-notice {
			background-color: @notice-color;
		}
	}

	&:not(.oo-ui-messageWidget-block) {
		&.oo-ui-flaggedElement-error {
			color: @alert-color;
		}

		&.oo-ui-flaggedElement-warning {
			color: @warning-color;
		}

		&.oo-ui-flaggedElement-success {
			color: @success-color;
		}

		&.oo-ui-flaggedElement-notice {
			color: @notice-color;
		}
	}
}
